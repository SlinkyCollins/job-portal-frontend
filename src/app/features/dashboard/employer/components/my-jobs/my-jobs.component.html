<div class="my-jobs-container fade-in">

  <div class="header-section">
    <div class="header-left">
      <h2 class="page-title">My Jobs</h2>
    </div>
    <div class="header-right">
      <div class="sort-section">
        <span class="sort-label">Sort by:</span>
        <select class="sort-dropdown" [(ngModel)]="selectedSort" (change)="onSortChange()">
          <option value="all">All</option>
          <option value="active">Active</option>
          <option value="pending">Pending</option>
          <option value="closed">Closed</option>
          <option value="new">New</option>
          <option value="old">Old</option>
        </select>
      </div>
    </div>
  </div>

  <div *ngIf="isLoading" class="responsive-table-wrapper skeleton-wrapper border-0">
    <div class="skeleton-table">
      <div class="skeleton-row" *ngFor="let i of [1,2,3,4,5]">

        <div class="skeleton-cell col-title"></div>

        <div class="skeleton-cell col-date"></div>

        <div class="skeleton-cell col-applicants"></div>

        <div class="skeleton-cell col-status"></div>

        <div class="skeleton-cell col-action"></div>

      </div>
    </div>
  </div>

  <div *ngIf="!isLoading && jobs.length === 0" class="empty-state">
    <img src="assets/EmptyImg.svg" alt="No Jobs" class="empty-icon">

    <!-- No jobs at all -->
    <div *ngIf="totalAllJobs === 0">
      <h4>No Jobs Posted Yet</h4>
      <p class="text-muted mb-4">You haven't posted any jobs. Get started now!</p>
      <button class="post-job-btn" routerLink="/dashboard/employer/post-job">Post a Job</button>
    </div>

    <!-- Jobs exist, but none match filter -->
    <div *ngIf="totalAllJobs > 0">
      <h4>No {{ selectedSort | titlecase }} Jobs Found</h4>
      <p class="text-muted mb-4">You have {{ totalAllJobs }} job{{ totalAllJobs > 1 ? 's' : '' }} posted, but none match
        the "{{ selectedSort }}" filter. Try a different filter.</p>
    </div>
  </div>

  <div *ngIf="!isLoading && jobs.length > 0" class="responsive-table-wrapper">
    <table class="responsive-table">
      <thead>
        <tr>
          <th>Title</th>
          <th>Job Created</th>
          <th class="col-applicants">Applicants</th>
          <th class="col-status">Status</th>
          <th class="col-action">Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let job of jobs">
          <td class="cell-title">
            <div class="job-title-main">{{ job.title }}</div>
            <div class="job-type-location">
              <i class="fas fa-briefcase"></i>
              {{ job.employment_type | titlecase }}
              <span>â€¢</span>
              {{ job.location }}
            </div>
          </td>
          <td class="cell-created">
            {{ job.published_at | date:'dd MMM, yyyy' }}
          </td>
          <td class="cell-applicants">
            <span class="applicants-count">{{ job.application_count }}</span>
            <span class="applicants-text">Applications</span>
          </td>
          <td class="cell-status">
            <span class="status-badge"
              [ngClass]="{'status-active': job.status === 'active', 'status-pending': job.status === 'pending', 'status-expired': job.status === 'expired', 'status-closed': job.status === 'closed'}">
              <span class="status-dot"></span>{{ job.status | titlecase }}
            </span>
          </td>
          <td class="cell-action">
            <div class="action-buttons">
              <button [routerLink]="['/dashboard/employer/edit-job', job.job_id]" class="action-btn edit-btn"
                title="Edit Job">
                <i class="fas fa-edit"></i>
              </button>
              <button class="action-btn delete-btn" (click)="deleteJob(job.job_id)" title="Delete Job">
                <i class="fas fa-trash-alt"></i>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div *ngIf="totalJobs > perPage" class="pagination-container mt-4">
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-center">
      <div class="pagination-info mb-3 mb-md-0">
        {{ getShowingText() }}
      </div>
      <nav aria-label="Job listings pagination">
        <ul class="pagination mb-0">
          <li class="page-item" [class.disabled]="currentPage === 1">
            <a class="page-link" href="#" (click)="prevPage(); $event.preventDefault();">Previous</a>
          </li>
          <li class="page-item" *ngFor="let page of getPagesArray()" [class.active]="page === currentPage">
            <a class="page-link" href="#" (click)="goToPage(page); $event.preventDefault();">{{ page }}</a>
          </li>
          <li class="page-item" [class.disabled]="currentPage === totalPages">
            <a class="page-link" href="#" (click)="nextPage(); $event.preventDefault();">Next</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <app-app-modal [isVisible]="showDeleteModal" title="Confirm Delete" message="Are you sure you want to delete this job?"
    subtitle="This action cannot be undone." iconClass="fas fa-exclamation-triangle" confirmText="Delete"
    cancelText="Cancel" (confirm)="confirmDelete()" (cancel)="cancelDelete()">
  </app-app-modal>
</div>